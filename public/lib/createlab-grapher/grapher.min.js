Math.log2=Math.log2||function(a){return Math.log(a)/Math.LN2};Math.log10=Math.log10||function(a){return Math.log(a)/Math.LN10};"use strict";var cr=cr||{};cr.Vector2=function(a,b){this._x=a;this._y=b};cr.Vector2.prototype.getX=function(){return this._x};cr.Vector2.prototype.getY=function(){return this._y};cr.Vector2.prototype.scale=function(a){return new cr.Vector2(this._x*a,this._y*a)};cr.Vector2.prototype.add=function(a){return new cr.Vector2(this._x+a._x,this._y+a._y)};
cr.Vector2.prototype.distance=function(a){return Math.sqrt(Math.pow(this._x-a._x,2)+Math.pow(this._y-a._y,2))};"use strict";cr=cr||{};cr.Basis=function(a,b){this.x=a;this.y=b};cr.Basis.YAxisBasis=new cr.Basis(new cr.Vector2(1,0),new cr.Vector2(0,-1));cr.Basis.XAxisBasis=new cr.Basis(new cr.Vector2(0,-1),new cr.Vector2(1,0));"use strict";cr=cr||{};cr.LabelFormatter={};cr.LabelFormatter.DAYS="Sun Mon Tue Wed Thu Fri Sat".split(" ");cr.LabelFormatter.VERBOSE_DAYS="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");
cr.LabelFormatter.MONTHS="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");cr.LabelFormatter.VERBOSE_MONTHS="January February March April May June July August September October November December".split(" ");cr.TimeLabelFormatter=function(){};
cr.TimeLabelFormatter.prototype.format=function(a){var b=Math.floor(a+5E-7);a=Math.round(1E6*(a-b));var c=new Date(1E3*b),b=String("00"+c.getHours()).slice(-2)+":"+String("00"+c.getMinutes()).slice(-2),c=c.getSeconds();if(0!=c||0!=a)b+=":"+c,0!=a&&(b+="."+a);return b};cr.VerboseDateLabelFormatter=function(){this.dayFormatter=new cr.VerboseDayLabelFormatter;this.monthFormatter=new cr.VerboseMonthLabelFormatter(!0)};
cr.VerboseDateLabelFormatter.prototype.format=function(a){return this.dayFormatter.format(a)+" "+this.monthFormatter.format(a)};cr.DateLabelFormatter=function(){this.dayFormatter=new cr.DayLabelFormatter;this.monthFormatter=new cr.MonthLabelFormatter(!0)};cr.DateLabelFormatter.prototype.format=function(a){return this.dayFormatter.format(a)+" "+this.monthFormatter.format(a)};cr.DateNumberLabelFormatter=function(){};
cr.DateNumberLabelFormatter.prototype.format=function(a){return(new Date(Math.round(1E3*a))).getDate()};cr.DayLabelFormatter=function(){this.dateNumberFormatter=new cr.DateNumberLabelFormatter};cr.DayLabelFormatter.prototype.format=function(a){var b=new Date(Math.round(1E3*a));return cr.LabelFormatter.DAYS[b.getDay()]+" "+this.dateNumberFormatter.format(a)};cr.VerboseDayLabelFormatter=function(){};
cr.VerboseDayLabelFormatter.prototype.format=function(a){a=new Date(Math.round(1E3*a));return cr.LabelFormatter.VERBOSE_DAYS[a.getDay()]+" "+a.getDate()};cr.MonthLabelFormatter=function(a){this.includeYear=a;this.YearLabelFormatter=new cr.YearLabelFormatter};cr.MonthLabelFormatter.prototype.format=function(a){var b=new Date(Math.round(1E3*a));return cr.LabelFormatter.MONTHS[b.getMonth()]+(this.includeYear?" "+this.YearLabelFormatter.format(a):"")};
cr.VerboseMonthLabelFormatter=function(a){this.includeYear=a;this.YearLabelFormatter=new cr.YearLabelFormatter};cr.VerboseMonthLabelFormatter.prototype.format=function(a){var b=new Date(Math.round(1E3*a));return cr.LabelFormatter.VERBOSE_MONTHS[b.getMonth()]+(this.includeYear?" "+this.YearLabelFormatter.format(a):"")};cr.YearLabelFormatter=function(){};cr.YearLabelFormatter.prototype.format=function(a){return(new Date(Math.round(1E3*a))).getYear()+1900};cr.YearSmallLabelFormatter=function(){};
cr.YearSmallLabelFormatter.prototype.format=function(a){a=(new Date(Math.round(1E3*a))).getYear()%100;0>a&&(a+=100);return(10>a?"'0":"'")+a};cr.DecadeLabelFormatter=function(){};cr.DecadeLabelFormatter.prototype.format=function(a){a=new Date(Math.round(1E3*a));a=10*Math.floor((a.getYear()+1900)/10);return a+" - "+(a+9)};cr.DecadeSmallLabelFormatter=function(){};
cr.DecadeSmallLabelFormatter.prototype.format=function(a){a=(new Date(Math.round(1E3*a))).getYear()%100;0>a&&(a+=100);a=10*Math.floor(a/10);return(0==a?"'0":"'")+a+"s"};cr.CenturyLabelFormatter=function(){};cr.CenturyLabelFormatter.prototype.format=function(a){a=new Date(Math.round(1E3*a));a=100*Math.floor((a.getYear()+1900)/100);return a+" - "+(a+99)};cr.CenturySmallLabelFormatter=function(){};
cr.CenturySmallLabelFormatter.prototype.format=function(a){a=new Date(Math.round(1E3*a));return 100*Math.floor((a.getYear()+1900)/100)+"s"};cr.DateTimeFormatter=function(){};cr.DateTimeFormatter.format=function(a){return"undefined"===typeof a||null==a||(a="[object Date]"===Object.prototype.toString.call(a)?a:new Date(a),isNaN(a.getTime()))?null:a.toDateString()+", "+a.toTimeString()};cr.ValueFormatter=function(){};
cr.ValueFormatter.format=function(a){if("undefined"!==typeof a&&null!=a){a=parseFloat(a);if(isFinite(a)&&!isNaN(a)){var b=Math.abs(a);return 0==b?"0.0":.001>b||1E7<b?a.toExponential():a.toPrecision()}return a.toString()}return null};"use strict";cr=cr||{};cr.TickGenerator=function(a,b){this._tickSize=a;this._offset=b;this._currentTick=0};
cr.TickGenerator.prototype.nextTick=function(a){if(a)for(this._min=a,this._currentTick=this.closestTick(a-this._tickSize);this._currentTick<a;)this.advanceTick();else this.advanceTick();return this._currentTick};
cr.TickGenerator.prototype.advanceTick=function(){this._prevTick=this._currentTick;this._currentTick=this.closestTick(this._currentTick+this._tickSize);if(this._currentTick<=this._prevTick){var a=Math.max(Math.abs(this._prevTick)/Math.pow(2,50),Number.MIN_VALUE);this._currentTick=this._prevTick+a}};cr.TickGenerator.prototype.closestTick=function(a){return Math.round((a-this._offset)/this._tickSize)*this._tickSize+this._offset};
cr.TickGenerator.closestDay=function(a){a=new Date(1E3*a);12<=a.getHours()+a.getMinutes()/30+a.getSeconds()/1800&&(a.setHours(23),a.setMinutes(59),a.setSeconds(59),a.setTime(a.getTime()+432E5));a.setHours(0);a.setMinutes(0);a.setSeconds(0);return Math.floor(a.getTime()/1E3+1E-10)};cr.DayTickGenerator=function(a,b){cr.TickGenerator.call(this,a,b)};cr.DayTickGenerator.prototype=Object.create(cr.TickGenerator.prototype);cr.DayTickGenerator.prototype.closestTick=function(a){return cr.TickGenerator.closestDay(a)};
cr.WeekTickGenerator=function(a,b){};cr.WeekTickGenerator.prototype=Object.create(cr.TickGenerator.prototype);cr.WeekTickGenerator.prototype.closestTick=function(a){var b=new Date(1E3*a),c=(3600*b.getSeconds()+b.getMinutes()+b.getHours())/24,b=b.getDay()-1;0>b&&(b+=7);c+=b;return 3.5<=c?cr.TickGenerator.closestDay(a+cr.TimeConstants.SECONDS_IN_DAY*(7-c)):cr.TickGenerator.closestDay(a-cr.TimeConstants.SECONDS_IN_DAY*c)};
cr.MonthTickGenerator=function(a,b){cr.TickGenerator.call(this,cr.TimeConstants.SECONDS_IN_MONTH*a,b);this._tickSizeMonths=a};cr.MonthTickGenerator.prototype=Object.create(cr.TickGenerator.prototype);
cr.MonthTickGenerator.prototype.closestTick=function(a){a=new Date(1E3*a);a=12*a.getYear()+a.getMonth()+a.getDate()*cr.TimeConstants.SECONDS_IN_DAY/cr.TimeConstants.SECONDS_IN_MONTH;a=Math.round(a/this._tickSizeMonths)*this._tickSizeMonths;var b=Math.floor(a/12);return Math.round((new Date(b+1900,a-12*b,1)).getTime()/1E3)};cr.YearTickGenerator=function(a,b){cr.MonthTickGenerator.call(this,12*a,b)};cr.YearTickGenerator.prototype=Object.create(cr.MonthTickGenerator.prototype);
cr.HourTickGenerator=function(a){cr.TickGenerator.call(this,cr.TimeConstants.SECONDS_IN_HOUR*a,0);this._tickSizeHours=a};cr.HourTickGenerator.prototype=Object.create(cr.TickGenerator.prototype);
cr.HourTickGenerator.prototype.closestTick=function(a){var b=new Date(1E3*a),c=b.getHours()+b.getMinutes()/30+b.getSeconds()/1800,d=Math.round(c/this._tickSizeHours)*this._tickSizeHours;if(24==d)return cr.TickGenerator.closestDay(a+(24-c)*cr.TimeConstants.SECONDS_IN_HOUR);b.setHours(d);b.setMinutes(0);b.setSeconds(0);return Math.floor(b.getTime()/1E3+1E-10)};"use strict";cr=cr||{};
cr.IterableTickGenerator=function(a,b,c){this._gen=a;this._maxValue=c;this._minValue=b;this._currTick=0;this._nextTick=a.nextTick(b)};cr.IterableTickGenerator.prototype.hasNext=function(){return this._nextTick<=this._maxValue};cr.IterableTickGenerator.prototype.next=function(){if(!this.hasNext())return!1;this._currTick=this._nextTick;this._nextTick=this._gen.nextTick();return this._currTick};"use strict";cr=cr||{};
cr.GraphAxis=function(a,b,c,d,e,f){this.id=cr.Uuid.getUuid();this._touchTargetPagePosition=this._canvas=this._div=null;this._min=b;this._max=c;this._basis=d;this.isXAxis=e;this._previousAxisChangeEvent=null;this._initDiv(a);this._initCanvas();this.majorTickMinSpacingPixels=cr.GraphAxis.Constants.DEFAULT_MAJOR_TICK_MIN_SPACING_PIXELS;this.majorTickWidthPixels=cr.GraphAxis.Constants.DEFAULT_MAJOR_TICK_WIDTH_PIXELS;this.minorTickMinSpacingPixels=cr.GraphAxis.Constants.DEFAULT_MINOR_TICK_MIN_SPACING_PIXELS;
this.minorTickWidthPixels=cr.GraphAxis.Constants.DEFAULT_MINOR_TICK_WIDTH_PIXELS;this.hasMinRange=!1;this.minRange=cr.GraphAxis.Constants.DEFAULT_MIN_RANGE;this.hasMaxRange=!1;this.maxRange=cr.GraphAxis.Constants.DEFAULT_MAX_RANGE;this._begin;this._length;this._scale;this._resolutionScale=window.devicePixelRatio||1;this.clampToRange();this.resize();this.lastMouse=null;a=$("#"+this._canvas.id);a.mousedown(this,this.mousedown);a.mousemove(this,this.mousemove);a.mouseup(this,this.mouseup);a.on("mousewheel",
this,this.mousewheel);this._previousTouches=null;this.touchUtils=new cr.TouchUtils;a.bind("touchstart",this,this.touchstart);a.bind("touchmove",this,this.touchmove);a.bind("touchend",this,this.touchend);a.bind("touchcancel",this,this.touchend);null==f&&(this.grapher=__grapher__);this.axisChangeListeners=[]};
cr.GraphAxis.Constants={DEFAULT_MAJOR_TICK_MIN_SPACING_PIXELS:30,DEFAULT_MAJOR_TICK_WIDTH_PIXELS:8,DEFAULT_MINOR_TICK_MIN_SPACING_PIXELS:10,DEFAULT_MINOR_TICK_WIDTH_PIXELS:3,DEFAULT_MIN_RANGE:-1E100,DEFAULT_MAX_RANGE:1E100};Object.freeze(cr.GraphAxis.Constants);cr.GraphAxis.prototype.mousedown=function(a){a.data.lastMouse=a;return!1};
cr.GraphAxis.prototype.mousemove=function(a){var b=a.data;if(a.which){if(b.lastMouse){if(b.isXAxis)if(b.cursorX){var c=b.project1D(b.cursorX)-10,d=b.project1D(b.cursorX)+10,e=Math.floor(b._div.clientHeight/2),f=b._div.clientHeight;c<=a.offsetX&&d>=a.offsetX&&e<=a.offsetY&&f>=a.offsetY?(b.setCursorPosition(b.cursorX+(a.clientX-b.lastMouse.clientX)/(b._canvas.width/b._resolutionScale/(b._max-b._min))),b.grapher.scheduleUpdate()):b.translatePixels(a.clientX-b.lastMouse.clientX)}else b.translatePixels(a.clientX-
b.lastMouse.clientX);else b.translatePixels(b.lastMouse.clientY-a.clientY);b.lastMouse=a}return!1}b.mouseup(a)};cr.GraphAxis.prototype.mouseup=function(a){a=a.data;a.lastMouse=null;a.publishAxisChangeEvent()};cr.GraphAxis.prototype.mousewheel=function(a){var b=a.data;b.isXAxis?b.zoomAboutX(a.offsetX,Math.pow(1.0005,-a.originalEvent.deltaY)):b.zoomAboutY(a.offsetY,Math.pow(1.0005,-a.originalEvent.deltaY));return!1};
cr.GraphAxis.prototype.touchstart=function(a){var b=a.data;b._previousTouches=cr.TouchUtils.filterTouchesForElement(a.originalEvent.touches,b._canvas.id).slice(0,2);2<=b._previousTouches.length&&(b._touchTargetPagePosition=cr.TouchUtils.getElementPagePosition(b._canvas));return!1};
cr.GraphAxis.prototype.touchmove=function(a){var b=a.data;a=cr.TouchUtils.filterTouchesForElement(a.originalEvent.touches,b._canvas.id).slice(0,2);if(b._previousTouches&&a.length==b._previousTouches.length){var c=b.touchUtils.centroid(a),d=b.touchUtils.centroid(b._previousTouches);b.isXAxis?(b.translatePixels(c.x-d.x),b.touchUtils.isXPinch(a)&&b.touchUtils.isXPinch(b._previousTouches)&&(c=c.x-b._touchTargetPagePosition.x,d=b.touchUtils.xSpan(a)/b.touchUtils.xSpan(b._previousTouches),b.zoomAboutX(c,
d))):(b.translatePixels(d.y-c.y),b.touchUtils.isYPinch(a)&&b.touchUtils.isYPinch(b._previousTouches)&&(c=c.y-b._touchTargetPagePosition.y,d=b.touchUtils.ySpan(a)/b.touchUtils.ySpan(b._previousTouches),b.zoomAboutY(c,d)))}b._previousTouches=b.touchUtils.copyTouches(a);return!1};cr.GraphAxis.prototype.touchend=function(a){a.data._previousTouches=null;return!1};
cr.GraphAxis.prototype.translatePixels=function(a){if(0!=a){var b=this.isXAxis?this._canvas.width/this._resolutionScale/(this._max-this._min):this._canvas.height/this._resolutionScale/(this._max-this._min);this._min-=a/b;this._max-=a/b;this.limitView()}};
cr.GraphAxis.prototype._initDiv=function(a){this._div=a;this._div.style.position="relative";this.isXAxis?a.clientHeight&&0<a.clientHeight&&isNaN(parseInt(this._div.style.height))&&(this._div.style.height=a.clientHeight+"px"):a.clientWidth&&0<a.clientWidth&&isNaN(parseInt(this._div.style.width))&&(this._div.style.width=a.clientWidth+"px")};
cr.GraphAxis.prototype._initCanvas=function(){this._canvas=document.createElement("canvas");this._canvas.setAttribute("id",this.isXAxis?this._div.id+"-x-axis-canvas":this._div.id+"y-axis-canvas");var a=parseInt(this._div.style.width),b=parseInt(this._div.style.height);this._canvas.style.width=a+"px";this._canvas.style.height=b+"px";this._canvas.width=a*this._resolutionScale;this._canvas.height=b*this._resolutionScale;this._canvas.style.position="absolute";this._div.appendChild(this._canvas);this._ctx=
this._canvas.getContext("2d")};cr.GraphAxis.prototype.resize=function(){this.width=parseInt(this._div.style.width);this.height=parseInt(this._div.style.height);this._canvas.style.width=this.width+"px";this._canvas.style.height=this.height+"px";this._canvas.width=this.width*this._resolutionScale;this._canvas.height=this.height*this._resolutionScale;this._ctx.scale(1,1);this._ctx.scale(this._resolutionScale,this._resolutionScale);this.layout()};
cr.GraphAxis.prototype.layout=function(){var a;a=this.isXAxis?this.width:this.height;this._begin=new cr.Vector2(0,this.height);this._length=a;this.rescale()};cr.GraphAxis.prototype.uncheckedTranslate=function(a){this._min+=a;this._max+=a};
cr.GraphAxis.prototype.clampToRange=function(){this.uncheckedTranslate(Math.max(0,this.minRange-this._min));this.uncheckedTranslate(Math.min(0,this.maxRange-this._max));if(this._min==Number.NEGATIVE_INFINITY||isNaN(this._min))this._min=Number.MIN_VALUE;if(this._max==Number.POSITIVE_INFINITY||isNaN(this._max))this._max=Number.MAX_VALUE;this.hasMinRange&&(this._min=Math.max(this._min,this.minRange));this.hasMaxRange&&(this._max=Math.min(this._max,this.maxRange))};
cr.GraphAxis.prototype.rescale=function(){this._scale=this._length/(this._max-this._min)};
cr.GraphAxis.prototype.paint=function(){this._ctx.clearRect(0,0,this._canvas.width,this.height);this._ctx.beginPath();var a=this.project2D(this._min),b=this.project2D(this._max);this._ctx.moveTo(a._x,a._y);this._ctx.lineTo(b._x,b._y);a=this.computeTickSize(this.majorTickMinSpacingPixels,1);this.renderTicks(0,a,this.majorTickWidthPixels,!0);a=this.computeTickSize(this.minorTickMinSpacingPixels,1);this.renderTicks(0,a,this.minorTickWidthPixels);this._ctx.stroke()};
cr.GraphAxis.prototype.project1D=function(a){return(a-this._min)*this._scale};cr.GraphAxis.prototype.project2D=function(a){return this._begin.add(this._basis.y.scale(this.project1D(a)))};cr.GraphAxis.prototype.computeTickSize=function(a,b){var c=a/this._length*(this._max-this._min)/(b||1),d=c/Math.pow(10,Math.floor(Math.log10(c)));return(5<d?10:2<d?5:1<d?2:1)/d*c};
cr.GraphAxis.prototype.renderTicks=function(a,b,c,d){var e=this.setupText()+a+c;b=new cr.TickGenerator(b,0);b=new cr.IterableTickGenerator(b,this._min,this._max);for(var f=b.next();!1!==f;)this.renderTick(f,a+c),d&&this.renderTickLabel(f,e),f=b.next()};cr.GraphAxis.prototype.renderTick=function(a,b){var c,d;c=this.project2D(a);d=c.add(this._basis.x.scale(b));this._ctx.moveTo(c._x,c._y);this._ctx.lineTo(d._x,d._y)};
cr.GraphAxis.prototype.renderTickLabel=function(a,b){var c=a,d=Math.abs(a),e="";1E3>d||(1E6>d?(a/=1E3,e="k"):1E9>d&&1E3!=d/1E6?(a/=1E6,e="M"):1E12>d&&1E3!=d/1E9?(a/=1E9,e="G"):1E15>d&&1E3!=d/1E12?(a/=1E12,e="T"):(a/=1E15,e="P"));d=a.toFixed(4);d=d.replace(/\.?0+$/g,"")+e;c=this.project2D(c).add(this._basis.x.scale(b));this._ctx.fillText(d,c._x,c._y)};
cr.GraphAxis.prototype.zoomAboutY=function(a,b){var c=this.pixelToY(a);this._min-=c;this._max-=c;this._min/=b;this._max/=b;this._min+=c;this._max+=c;this.limitView()};cr.GraphAxis.prototype.zoomAboutX=function(a,b){var c=this.pixelToX(a);this._min-=c;this._max-=c;this._min/=b;this._max/=b;this._min+=c;this._max+=c;this.limitView()};
cr.GraphAxis.prototype.limitView=function(){this._max-this._min>this.maxRange-this.minRange?(this._max=this.maxRange,this._min=this.minRange):this._min<this.minRange?(this._max+=this.minRange-this._min,this._min=this.minRange):this._max>this.maxRange&&(this._min-=this._max-this.maxRange,this._max=this.maxRange);this.publishAxisChangeEvent();this.grapher.scheduleUpdate()};cr.GraphAxis.prototype.pixelToX=function(a){return a/(this._canvas.width/this._resolutionScale/(this._max-this._min))- -this._min};
cr.GraphAxis.prototype.xToPixel=function(a){return a*(this._canvas.width/this._resolutionScale/(this._max-this._min)- -this._min)};cr.GraphAxis.prototype.pixelToY=function(a){return a/(this._canvas.height/this._resolutionScale/(this._min-this._max))- -this._max};
cr.GraphAxis.prototype.setupText=function(){var a=0;Math.abs(this._basis.x.getY())>Math.abs(this._basis.y.getY())?(this._ctx.textAlign="center",this._ctx.textBaseline="top",a=Math.floor(this.height/2.66)):(this._ctx.textAlign="left",this._ctx.textBaseline="middle",a=3);return a};cr.GraphAxis.prototype.setRange=function(a,b){a<b&&(this._min=a,this._max=b,this.publishAxisChangeEvent(),this.grapher.scheduleUpdate())};cr.GraphAxis.prototype.getRange=function(){return{min:this._min,max:this._max}};
cr.GraphAxis.prototype.getMin=function(){return this._min};cr.GraphAxis.prototype.getMax=function(){return this._max};cr.GraphAxis.prototype.setBounds=function(a){this.isXAxis?this.setRange(a.xmin,a.xmax):this.setRange(a.ymin,a.ymax)};cr.GraphAxis.prototype.update=function(a){a&&this.setBounds(a);this.clampToRange();this.rescale();this.paint()};cr.GraphAxis.prototype.setSize=function(a,b){this._div.style.width=a+"px";this._div.style.height=b+"px";this.resize();this.grapher.resize();this.publishAxisChangeEvent()};
cr.GraphAxis.prototype.setMaxRange=function(a,b){var c=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};c(a)&&a>=cr.GraphAxis.Constants.DEFAULT_MIN_RANGE?(this.minRange=a,this.hasMinRange=!0):(this.minRange=cr.GraphAxis.Constants.DEFAULT_MIN_RANGE,this.hasMinRange=!1);c(b)&&b<=cr.GraphAxis.Constants.DEFAULT_MAX_RANGE?(this.maxRange=b,this.hasMaxRange=!0):(this.maxRange=cr.GraphAxis.Constants.DEFAULT_MAX_RANGE,this.hasMaxRange=!1);this.update();this.grapher.scheduleUpdate();this.publishAxisChangeEvent()};
cr.GraphAxis.prototype.getId=function(){return this._div.id};cr.GraphAxis.prototype.addAxisChangeListener=function(a){this.axisChangeListeners.push(a)};cr.GraphAxis.prototype.removeAxisChangeListener=function(a){for(var b=0;b<this.axisChangeListeners.length&&this.axisChangeListeners[b]!=a;b++);b<this.axisChangeListeners.length&&this.axisChangeListeners.splice(b,1)};
cr.GraphAxis.prototype.publishAxisChangeEvent=function(){var a={min:this._min,max:this._max,cursorPosition:this.cursorX,cursorPositionString:cr.DateTimeFormatter.format(1E3*this.cursorX),eventId:-1};if(null==this._previousAxisChangeEvent||this._previousAxisChangeEvent.min!=a.min||this._previousAxisChangeEvent.max!=a.max||this._previousAxisChangeEvent.cursorPosition!=a.cursorPosition)for(var b=0;b<this.axisChangeListeners.length;b++)this.axisChangeListeners[b](a);this._previousAxisChangeEvent=a};
cr.GraphAxis.prototype.getMax=function(){return this._max};cr.GraphAxis.prototype.getMin=function(){return this._min};"use strict";cr=cr||{};
cr.TimeGraphAxis=function(a,b,c,d,e){cr.GraphAxis.call(this,a,b,c,d,e);this._timeTickSizes=[[1,5,15,30],[60,300,900,1800],[3600,10800,21600,43200],[cr.TimeConstants.SECONDS_IN_DAY],[cr.TimeConstants.SECONDS_IN_WEEK],[cr.TimeConstants.SECONDS_IN_MONTH,3*cr.TimeConstants.SECONDS_IN_MONTH,6*cr.TimeConstants.SECONDS_IN_MONTH],[cr.TimeConstants.SECONDS_IN_YEAR]];this._minRange=-21474836400;this._maxRange=21474836400;this._hasMinRange=this._hasMaxRange=!0;this._days="Sun Mon Tue Wed Thu Fri Sat".split(" ");
this._verboseDays="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ");this._months="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");this._verboseMonths="January February March April May June July August September October November December".split(" ");this.grapher.timeGraphAxis=this;this.showCursor=!1;this.cursorX=null};cr.TimeGraphAxis.prototype=Object.create(cr.GraphAxis.prototype);
cr.TimeGraphAxis.prototype.paint=function(){this._ctx.clearRect(0,0,this.width,this.height);this._ctx.beginPath();var a=this.project2D(this._min),b=this.project2D(this._max);this._ctx.moveTo(a._x,a._y);this._ctx.lineTo(b._x,b._y);a=this.project2D(this._min);b=this.project2D(this._max);this._ctx.moveTo(a._x,a._y/2);this._ctx.lineTo(b._x,b._y/2);var c=this.computeTimeTickSize(50),d=this.computeTimeTickSize(10),a=this.height/2,b=cr.TimeConstants.SECONDS_IN_DAY,e=this.computeTickWidth(b),f=cr.TimeConstants.SECONDS_IN_MONTH,
g=this.computeTickWidth(f),h=cr.TimeConstants.SECONDS_IN_YEAR,k=this.computeTickWidth(h),l=cr.TimeConstants.SECONDS_IN_DECADE,m=this.computeTickWidth(l),n=cr.TimeConstants.SECONDS_IN_CENTURY,p=this.computeTickWidth(n);80<=e?(a=120<=e?new cr.VerboseDateLabelFormatter:new cr.DateLabelFormatter,this.renderTicksRangeLabelInline(this.height/2,b,this.createDateTickGenerator(b),this.height,a),d<=43200+1E-10&&(this.renderTicks(0,c,this.createDateTickGenerator(c),this.majorTickWidthPixels,null,null),this.renderLabels(0,
c,this.createDateTickGenerator(c),0,new cr.TimeLabelFormatter),a=this.computeTimeMinorTickSize(5,c),this.renderTicks(0,a,this.createDateTickGenerator(a),this.minorTickWidthPixels,null,null))):150<=g?(this.renderTicks(0,b,this.createDateTickGenerator(b),this.majorTickWidthPixels,null,null),h=null,l=new cr.VerboseMonthLabelFormatter(!0),40<=e?h=new cr.DayLabelFormatter:15<=e&&(h=new cr.DateNumberLabelFormatter),this.renderRangeLabelInline(0,b,this.createDateTickGenerator(b),0,h),this.renderTicksRangeLabelInline(a,
f,this.createDateTickGenerator(f),this.height,l)):80<=k?(this.renderTicks(0,f,this.createDateTickGenerator(f),this.majorTickWidthPixels,null,null),l=null,55<=g?l=new cr.VerboseMonthLabelFormatter(!1):20<=g&&(l=new cr.MonthLabelFormatter(!1)),this.renderRangeLabelInline(0,f,this.createDateTickGenerator(f),0,l),this.renderTicksRangeLabelInline(a,h,this.createDateTickGenerator(h),this.height,new cr.YearLabelFormatter)):150<=m?(this.renderTicks(0,h,this.createDateTickGenerator(h),this.majorTickWidthPixels,
null,null),b=null,30<=k?b=new cr.YearLabelFormatter:15<=k&&(b=new cr.YearSmallLabelFormatter),this.renderRangeLabelInline(0,h,this.createDateTickGenerator(h),0,b),this.renderTicksRangeLabelInline(a,l,this.createDateTickGenerator(l),this.height,new cr.DecadeLabelFormatter)):(this.renderTicks(0,l,this.createDateTickGenerator(l),this.majorTickWidthPixels,null,null),b=null,65<=m?b=new cr.DecadeLabelFormatter:25<=m&&(b=new cr.DecadeSmallLabelFormatter),this.renderRangeLabelInline(0,l,this.createDateTickGenerator(l),
0,b),b=new cr.CenturySmallLabelFormatter,65<=p&&(b=new cr.CenturyLabelFormatter),this.renderTicksRangeLabelInline(a,n,this.createDateTickGenerator(n),this.height,b));this._ctx.stroke();this.cursorX&&(this._ctx.fillStyle="red",this._ctx.beginPath(),this._ctx.moveTo(this.project1D(this.cursorX),this._div.clientHeight),this._ctx.lineTo(this.project1D(this.cursorX)+10,Math.floor(this._div.clientHeight/2)),this._ctx.lineTo(this.project1D(this.cursorX)-10,Math.floor(this._div.clientHeight/2)),this._ctx.fill(),
this._ctx.fillStyle="black")};cr.TimeGraphAxis.prototype.computeTimeTickSize=function(a){var b=a/this._length*(this._max-this._min);if(1>b)return this.computeTickSize(a);for(var c=0;c<this._timeTickSizes.length;c++)for(var d=0;d<this._timeTickSizes[c].length;d++)if(this._timeTickSizes[c][d]>=b)return this._timeTickSizes[c][d];return this.computeTickSize(a,cr.TimeConstants.SECONDS_IN_YEAR)*cr.TimeConstants.SECONDS_IN_YEAR};
cr.TimeGraphAxis.prototype.computeTimeMinorTickSize=function(a,b){if(b<=1+1E-10)return this.computeTickSize(a);for(var c=0;c<this._timeTickSizes.length;c++)for(var d=0;d<this._timeTickSizes[c].length;d++)if(b<=this._timeTickSizes[c][d])return Math.max(0==d?this._timeTickSizes[c-1][0]:this._timeTickSizes[c][0],this.computeTimeTickSize(a));return this.computeTimeTickSize(a)};
cr.TimeGraphAxis.prototype.renderTicks=function(a,b,c,d,e,f){null==c&&(c=new cr.TickGenerator(b,0));b=null==e?0:this.setupText()+a+d;c=new cr.IterableTickGenerator(c,this._min,this._max);for(var g=c.next();!1!==g;)this.renderTick(g,a+d),null!=e&&this.renderTickLabelWithFormatter(g,b,e,f),g=c.next()};
cr.TimeGraphAxis.prototype.renderTickLabelWithFormatter=function(a,b,c,d){c=c.format(a);if(null!=d){var e=this._ctx.measureText(c).width,f=this.project2D(a).add(this.basis.x.scale(b))._x;0>this.width-e-f&&(c=d.format(a))}this.renderTickLabel(a,b,c)};cr.TimeGraphAxis.prototype.renderTickLabel=function(a,b,c){a=this.project2D(a).add(this._basis.x.scale(b));this._ctx.fillText(c,a._x,a._y)};cr.TimeGraphAxis.prototype.computeTickWidth=function(a){return this.project2D(a).distance(this.project2D(0))};
cr.TimeGraphAxis.prototype.createDateTickGenerator=function(a){var b=Math.round(a/cr.TimeConstants.SECONDS_IN_HOUR);if(1>=b)return null;if(24>b)return new cr.HourTickGenerator(b);if(1==Math.round(a/cr.TimeConstants.SECONDS_IN_DAY))return new cr.DayTickGenerator(cr.TimeConstants.SECONDS_IN_DAY,0);if(1==Math.round(a/cr.TimeConstants.SECONDS_IN_WEEK))return new cr.WeekTickGenerator(cr.TimeConstants.SECONDS_IN_WEEK,0);b=Math.round(a/cr.TimeConstants.SECONDS_IN_MONTH);if(12>b)return new cr.MonthTickGenerator(b,
0);a=Math.round(a/cr.TimeConstants.SECONDS_IN_YEAR);return new cr.YearTickGenerator(a)};
cr.TimeGraphAxis.prototype.renderRangeLabelInline=function(a,b,c,d,e){if(null!=e){null==c&&(c=new cr.TickGenerator(b,0));a=this.setupText()+a;var f=c.nextTick(this._min);if(f>this._max)this.renderTickLabelWithFormatter((this._min+this._max)/2,a,e,null);else for(f=c.nextTick(this._min-b);;){d=c.nextTick();if(d>this._max+b)break;var g=d;f<this._min&&(f=this._min);g>this._max&&(g=this._max);this.renderTickLabelWithinBounds((f+g)/2,f,g,a,e);f=d}}};
cr.TimeGraphAxis.prototype.renderTickLabelWithinBounds=function(a,b,c,d,e){var f=e.format(a);if(Math.abs(this._basis.x._x)<Math.abs(this._basis.x._y)){e=this._ctx.measureText(f).width;var g=this.project2D(a)._x,h=this.project2D(b)._x,k=this.project2D(c)._x;if(!(e>=k-h)){var l=g;"center"==this._ctx.textAlign?(g+=e/2,l-e/2<=h?(this._ctx.textAlign="left",this.renderTickLabel(b,d,f),this._ctx.textAlign="center"):g>=k?(this._ctx.textAlign="right",this.renderTickLabel(c,d,f),this._ctx.textAlign="center"):
this.renderTickLabel(a,d,f)):this.renderTickLabel(a,d,f)}}else this.renderTickLabel(a,d,e(a))};
cr.TimeGraphAxis.prototype.renderTicksRangeLabelInline=function(a,b,c,d,e){null==c&&(c=new cr.TickGenerator(b,0));var f=this.setupText()+a,g=c.nextTick(this._min);if(g>this._max)this.renderTickLabelWithFormatter((this._min+this._max)/2,f,e,null);else for(g=c.nextTick(this._min-b);;){this.renderTick(g,d+a);var h=c.nextTick();if(h>this._max+b)break;var k=h;g<this._min&&(g=this._min);k>this._max&&(k=this._max);this.renderTickLabelWithinBounds((g+k)/2,g,k,f,e);g=h}};
cr.TimeGraphAxis.prototype.renderLabels=function(a,b,c,d,e){null==c&&(c=new cr.TickGenerator(b,0));a=null==e?0:this.setupText()+a+d;c=new cr.IterableTickGenerator(c,this._min,this._max);for(b=c.next();!1!==b;)this.renderTickLabelWithFormatter(b,a,e,null),b=c.next()};cr.TimeGraphAxis.prototype.setCursorPosition=function(a){a!=this.cursorX&&(this.cursorX=a);this.publishAxisChangeEvent()};cr.TimeGraphAxis.prototype.getCursorPosition=function(){return this.cursorX};"use strict";cr=cr||{};
cr.Glb=function(a){this.gl=a;this._shaderCache={};this._programCache={}};cr.Glb.prototype._shaderFromSource=function(a,b){var c=this._shaderCache[b];c||(c=this._shaderCache[b]={});var d=c[a];if(!d&&(d=c[a]=this.gl.createShader(a),this.gl.shaderSource(d,b),this.gl.compileShader(d),!this.gl.getShaderParameter(d,this.gl.COMPILE_STATUS)))throw Error("Compiling shader, "+this.gl.getShaderInfoLog(d));return d};
cr.Glb.prototype.programFromSources=function(a,b){var c=this._programCache[a];c||(c=this._programCache[a]={});var d=c[b];if(!d&&(console.log("Creating shader program"),d=c[b]=this.gl.createProgram(),this.gl.attachShader(d,this._shaderFromSource(this.gl.VERTEX_SHADER,a)),this.gl.attachShader(d,this._shaderFromSource(this.gl.FRAGMENT_SHADER,b)),this.gl.linkProgram(d),!this.gl.getProgramParameter(d,this.gl.LINK_STATUS)))throw Error("Linking shader program, "+this.gl.getProgramInfoLog(d));this._addAttribsAndUniformsToProgram(d);
return d};cr.Glb.prototype._addAttribsAndUniformsToProgram=function(a){if(0==this.gl.getProgramParameter(a,this.gl.ACTIVE_ATTRIBUTES))throw Error("Program has no active attributes");for(var b=this.gl.getProgramParameter(a,this.gl.ACTIVE_ATTRIBUTES)-1;0<=b;b--){var c=this.gl.getActiveAttrib(a,b).name;a[c]=this.gl.getAttribLocation(a,c)}for(b=this.gl.getProgramParameter(a,this.gl.ACTIVE_UNIFORMS)-1;0<=b;b--)c=this.gl.getActiveUniform(a,b).name,a[c]=this.gl.getUniformLocation(a,c)};
cr.Glb.prototype.createBuffer=function(a){var b=this.gl.createBuffer();this.gl.bindBuffer(this.gl.ARRAY_BUFFER,b);this.gl.bufferData(this.gl.ARRAY_BUFFER,a,this.gl.STATIC_DRAW);return b};cr.Glb.prototype.clear=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT)};"use strict";cr=cr||{};
cr.TileIdx=function(a,b){this.l=a;this.o=b;var c,d;c=0>a?"-"+("00"+a.toString().split("-")[1]).substr(-3):("00"+a).substr(-3);d=0>b?"-"+("00000000000000000000"+b.toString().split("-")[1]).substr(-19):("00000000000000000000"+b).substr(-19);this.key=c+d};cr.TileIdx.prototype.parent=function(){return new cr.TileIdx(this.l+1,this.o>>1)};cr.TileIdx.prototype.toString=function(){return this.l+"."+this.o};"use strict";cr=cr||{};
cr.TileLoader=function(a){if("function"!==typeof a)throw Error("The datasource must be a function.");this._datasource=a};
cr.TileLoader.prototype.load=function(a,b){if("function"!==typeof b)throw Error("The callback must be a function.");try{this._datasource(a.l,a.o,function(a){if("undefined"===typeof a||null==a)b(Error("Datasource loaded undefined or null JSON for tile ["+this._tileidx.toString()+"]"));else{if("string"===typeof a||a instanceof String)try{a=JSON.parse(a)}catch(c){return b(Error("Datasource loaded invalid JSON string for tile ["+this._tileidx.toString()+"]: "+c))}if(null!=a&&"object"===typeof a&&!Array.isArray(a)&&
Array.isArray(a.data))b(null,a);else return b(Error("Datasource loaded invalid JSON object for tile ["+this._tileidx.toString()+"]: "))}})}catch(c){return b(Error("Error while calling datasource function for tile ["+this._tileidx.toString()+"]: "+c))}};"use strict";cr=cr||{};
cr.TileView=function(a){this._createTileCallback=a.createTile;this._deleteTileCallback=a.deleteTile;this._tiles={};this._updateTileCallback=a.updateTile;this._zoomlock=a.zoomlock;this._cache=a.cache||!1;this._tilecache={};this._readyList=[];console.log(this.toString())};cr.TileView.prototype.toString=function(){return"TileView: "};cr.TileView.prototype._computeLevel=function(a){a=a.max-a.min;return 0>=a?Number.MIN_VALUE:Math.floor(Math.log2(a/512))};
cr.TileView.prototype._computeOffset=function(a,b){var c=512*Math.pow(2,b);return Math.floor(a/c)};cr.TileView.prototype._tileidxAt=function(a,b){return new cr.TileIdx(a,b)};cr.TileView.prototype._computeVisibleTileRange=function(a,b){var c=this._tileidxAt(a,this._computeOffset(b.min,a)),d=this._tileidxAt(a,this._computeOffset(b.max,a));return{min:c,max:d}};cr.TileView.prototype._isTileVisible=function(a,b){var c=this._computeVisibleTileRange(a.l,b);return c.min.o<=a.o&&a.o<=c.max.o};
cr.TileView.prototype._addTileidx=function(a){this._tiles[a.key]||(this._tiles[a.key]=this._createTileCallback(a),this._tiles[a.key].index=a);return this._tiles[a.key]};cr.TileView.prototype._deleteTile=function(a){this._tiles[a.index.key]&&(a.delete(),delete this._tiles[a.index.key])};cr.TileView.prototype._destroy=function(){for(var a=Object.keys(this._tiles),b=0;b<a.length;b++){var c=a[b];this._deleteTile(this._tiles[c]);delete this._tiles[c]}};
cr.TileView.prototype.tileInfo=function(){for(var a=[],b=Object.keys(this._tiles).sort(),c=0;c<b.length;c++)a.push(b[c].toString());return"tileInfo: "+a.join(" ")};cr.TileView.prototype._findReadyAncestor=function(a){for(var b=0;5>b;){a=a.parent();if(null==a)return null;if(this._tiles[a.key]&&this._tiles[a.key].isReady())return a;b+=1}};cr.TileView.prototype._findFirstAncestorIn=function(a,b){for(;;){a=a.parent();if(null==a)return null;if(a.key in b)return a}};
cr.TileView.prototype.setView=function(a){for(var b={},c={},d=this._computeLevel(a),e=this._computeVisibleTileRange(d,a),f=e.min.o;f<=e.max.o;f++){var g=new cr.TileIdx(d,f);g.key in this._tiles||(this._tiles[g.key]=this._addTileidx(g),c[g.key]=!0);b[g.key]=!0;this._tiles[g.key].isReady()||(g=this._findReadyAncestor(g),null!=g&&(b[g.key]=!0))}var e=[],h;for(h in this._tiles)f=this._tiles[h]._tileidx,f.l<d&&this._isTileVisible(f,a)&&this._tiles[f.key].isReady()&&e.push(f);e=e.sort();for(a=0;a<e.length;a++)f=
e[a],h=this._findFirstAncestorIn(f,b),null==h||this._tiles[h.key].isReady()||(b[f.key]=!0);d=Object.keys(this._tiles).sort();e=[];for(a=0;a<d.length;a++)h=d[a],f=this._tiles[h],b[h]?(g="",c[h]&&(g+="+"),f.isReady()||(g+="("),g+=f.index.toString(),f.isReady()||(g+=")"),e.push(g)):(this._deleteTile(this._tiles[h]),delete this._tiles[h]);e=e.join(" ");this._lastStatus&&e.replace(/[\-\+]/g,"")==this._lastStatus.replace(/[\-\+]/g,"")||(console.log("setView: "+e),this._lastStatus=e);this._needsUpdate=!1;
for(a=0;a<d.length;a++)if(h=d[a],(f=this._tiles[h])&&!f.isReady()){this._needsUpdate=!0;break}};cr.TileView.prototype.update=function(a){for(var b=Object.keys(this._tiles).sort(),c=[],d=0;d<b.length;d++)c.push(this._tiles[b[d]]);this._updateTileCallback(c,a)};"use strict";cr=cr||{};
cr.DataStoreTile=function(a,b,c){this.glb=a;this.gl=a.gl;this._tileidx=b;this._ready=!1;this.program=a.programFromSources(cr.Shaders.TileVertexShader,cr.Shaders.TileFragmentShader);this.pointProgram=a.programFromSources(cr.Shaders.PointVertexShader,cr.Shaders.PointFragmentShader);this.offset=0;this._resolutionScale=window.devicePixelRatio||1;var d=this;(new cr.TileLoader(c)).load(b,function(a,b){if(a)console.log(a);else{var c=[],h=0;if(0<b.data.length)for(var h=b.data[0][0],k=0;k<b.data.length;k++)c.push(b.data[k][0]-
h),c.push(b.data[k][1]),c.push(b.data[k][2]),c.push(b.data[k][3]);d.offset=h;d._setData(new Float32Array(c))}})};cr.DataStoreTile.prototype._setData=function(a){var b=this.gl;this._pointCount=a.length/4;this._data=a;this._arrayBuffer=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,this._arrayBuffer);b.bufferData(b.ARRAY_BUFFER,this._data,b.STATIC_DRAW);a=b.getAttribLocation(this.program,"a_position");b.enableVertexAttribArray(a);b.vertexAttribPointer(a,2,b.FLOAT,!1,16,0);this._ready=!0};
cr.DataStoreTile.prototype.isReady=function(){return this._ready};cr.DataStoreTile.prototype.delete=function(){console.log("delete: "+this._tileidx.toString())};
cr.DataStoreTile.prototype.draw=function(a){var b=this.gl;if(this._ready){b.lineWidth(1);b.useProgram(this.program);var c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),d=2/(a.xmax-a.xmin),e=(-a.xmin+this.offset)*d-1,f=2/(a.ymax-a.ymin);a=-a.ymin*f-1;c[0]=d;c[12]=e;c[5]=f;c[13]=a;d=b.getUniformLocation(this.program,"u_pMatrix");b.uniformMatrix4fv(d,!1,c);b.bindBuffer(b.ARRAY_BUFFER,this._arrayBuffer);d=b.getAttribLocation(this.program,"a_position");b.enableVertexAttribArray(d);b.vertexAttribPointer(d,
2,b.FLOAT,!1,16,0);d=b.getUniformLocation(this.program,"u_color");b.uniform4f(d,0,0,0,1);b.drawArrays(b.LINE_STRIP,0,this._pointCount);b.useProgram(this.pointProgram);d=b.getUniformLocation(this.pointProgram,"u_pMatrix");b.uniformMatrix4fv(d,!1,c);b.bindBuffer(b.ARRAY_BUFFER,this._arrayBuffer);d=b.getAttribLocation(this.pointProgram,"a_position");b.enableVertexAttribArray(d);b.vertexAttribPointer(d,2,b.FLOAT,!1,16,0);d=b.getUniformLocation(this.pointProgram,"u_color");b.uniform4f(d,0,0,0,1);c=b.getUniformLocation(this.pointProgram,
"u_size");b.uniform1f(c,4*this._resolutionScale);b.drawArrays(b.POINTS,0,this._pointCount)}};cr.DataStoreTile.update=function(a,b){for(var c=0;c<a.length;c++)a[c].draw(b)};"use strict";cr=cr||{};
cr.CanvasTile=function(a,b,c){this.ctx=a;this.canvas2d=a.canvas;this._tileidx=b;this._datasource=c;this._ready=!1;this._resolutionScale=window.devicePixelRatio||1;var d=this;(new cr.TileLoader(c)).load(b,function(a,b){if(a)console.log(a);else{for(var c=[],h=0;h<b.data.length;h++)c.push(b.data[h][0]),c.push(b.data[h][1]),c.push(b.data[h][2]),c.push(b.data[h][3]);d._setData(c)}})};cr.CanvasTile.prototype._setData=function(a){this._pointCount=a.length/4;this._data=a;this._ready=!0};
cr.CanvasTile.prototype.isReady=function(){return this._ready};cr.CanvasTile.prototype.delete=function(){console.log("delete: "+this._tileidx.toString())};
cr.CanvasTile.prototype.draw=function(a){if(this._ready){for(var b=0;b<=4*this._pointCount;b+=2)this.ctx.beginPath(),this.ctx.strokeStyle="black",this.ctx.lineWidth=1,this.ctx.moveTo(a.xScale*(this._data[2*b+0]+a.xOffset),a.yScale*(this._data[2*b+1]+a.yOffset)),this.ctx.lineTo(a.xScale*(this._data[2*b+4]+a.xOffset),a.yScale*(this._data[2*b+5]+a.yOffset)),this.ctx.stroke();for(b=0;b<=4*this._pointCount;b+=4)this.ctx.beginPath(),this.ctx.fillStyle="black",this.ctx.arc(a.xScale*(this._data[b+0]+a.xOffset),
a.yScale*(this._data[b+1]+a.yOffset),2*this._resolutionScale,0,2*Math.PI,!0),this.ctx.fill()}};cr.CanvasTile.update=function(a,b){for(var c=0;c<a.length;c++)a[c].draw(b)};"use strict";cr=cr||{};
cr.DataStoreTileLayer=function(a,b,c){this.glb=b;this.ctx=c;var d=this;this._tileView=new cr.TileView({createTile:function(e,f){return d.glb&&d.usewebgl?new cr.DataStoreTile(b,e,a):new cr.CanvasTile(c,e,a)},deleteTile:function(a){},updateTile:d.glb&&d.useWebgl?cr.DataStoreTile.update:cr.CanvasTile.update});this.destroy=function(){this._tileView._destroy()}};cr.DataStoreTileLayer.prototype.draw=function(a){this.glb&&this.usewebgl?this.drawWebgl(a):this.drawCanvas(a);this._needsUpdate=this._tileView._needsUpdate};
cr.DataStoreTileLayer.prototype.drawWebgl=function(a){var b=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),c=2/(a.xmax-a.xmin),d=-a.xmin*c-1,e=2/(a.ymax-a.ymin),f=-a.ymin*e-1;b[0]=c;b[12]=d;b[5]=e;b[13]=f;this._tileView.setView({min:a.xmin,max:a.xmax});this._tileView.update(a)};
cr.DataStoreTileLayer.prototype.drawCanvas=function(a){var b={};b.xOffset=-a.xmin;b.xScale=this.ctx.canvas.width/(a.xmax-a.xmin);b.yOffset=-a.ymax;b.yScale=this.ctx.canvas.height/(a.ymin-a.ymax);this._tileView.setView({min:a.xmin,max:a.xmax});this._tileView.update(b)};
cr.DataStoreTileLayer.prototype.search=function(a){for(var b=Object.keys(this._tileView._tiles).sort(),c=0;c<b.length;c++){var d=this._tileView._tiles[b[c]].offset||0,e=this._tileView._tiles[b[c]]._data;if(e)for(var f=0;f<e.length;f+=4)if(a.xmin<=e[f]+d&&a.xmax>=e[f]+d&&a.ymin<=e[f+1]&&a.ymax>=e[f+1])return{x:e[f]+d,y:e[f+1],tile:this._tileView._tiles[b[c]]}}return null};
cr.DataStoreTileLayer.prototype.getPointsNearTimeWithinTimeRange=function(a,b,c){b=a-Math.abs(b);c=a+Math.abs(c);for(var d=Object.keys(this._tileView._tiles).sort(),e=Number.MAX_VALUE,f={closestPoint:null,points:[]},g=0;g<d.length;g++){var h=this._tileView._tiles[d[g]].offset||0,k=this._tileView._tiles[d[g]]._data;if(k)for(var l=0;l<k.length;l+=4){var m=k[l]+h;if(m>=b&&m<=c){var n={x:m,y:k[l+1]},m=Math.abs(m-a);if(null==f.closestPoint||m<e)f.closestPoint=n,e=m;f.points.push(n)}}}return f};
cr.DataStoreTileLayer.prototype.getMinMaxValue=function(a){for(var b=Object.keys(this._tileView._tiles).sort(),c=null,d=!1,e=0;e<b.length;e++){var f=this._tileView._tiles[b[e]].offset||0,g=this._tileView._tiles[b[e]]._data;if(g){null==c&&(c={min:Number.MAX_VALUE,max:-Number.MAX_VALUE});for(var h=0;h<g.length;h+=4){var k=g[h]+f,l=g[h+1];isFinite(l)&&l>cr.TileConstants.TILE_BOUNDARY_SENTINAL_VALUE&&k>=a.min&&k<=a.max&&(c.min=Math.min(c.min,l),c.max=Math.max(c.max,l),d=!0)}}}return d?c:null};"use strict";
cr=cr||{};cr.Shaders=cr.Shaders||{};cr.Shaders.TileFragmentShader="  precision highp float;\n  uniform vec4 u_color;\n  void main(void) {\n    gl_FragColor = u_color;\n  }";cr.Shaders.TileVertexShader="  attribute vec3 a_position;\n  uniform mat4 u_pMatrix;\n  void main(void) {\n    gl_Position = u_pMatrix * vec4(a_position, 1.0);\n  }";cr.Shaders.PointFragmentShader="  precision highp float;\n  uniform vec4 u_color;\n  void main(void) {\n    float dist = length(gl_PointCoord.xy - vec2(.5,.5));\n    float alpha = (dist > .5) ? .0 : 1.;\n    gl_FragColor = u_color * alpha;\n  }";
cr.Shaders.PointVertexShader="  attribute vec3 a_position;\n  uniform float u_size;\n  uniform mat4 u_pMatrix;\n  void main(void) {\n    gl_Position = u_pMatrix * vec4(a_position, 1.0);\n    gl_PointSize = u_size;\n  }";"use strict";cr=cr||{};cr.TouchUtils=function(){};cr.TouchUtils.prototype._getX=function(a){return a instanceof Touch?a.pageX:a.x};cr.TouchUtils.prototype._getY=function(a){return a instanceof Touch?a.pageY:a.y};
cr.TouchUtils.prototype.copyTouches=function(a){for(var b=[],c=0;c<a.length;c++)b.push({x:this._getX(a[c]),y:this._getY(a[c])});return b};cr.TouchUtils.prototype.centroid=function(a){if(1==a.length)return{x:this._getX(a[0]),y:this._getY(a[0])};for(var b={x:0,y:0},c=0;c<a.length;c++)b.x+=this._getX(a[c]),b.y+=this._getY(a[c]);b.x/=a.length;b.y/=a.length;return b};cr.TouchUtils.prototype.xSpan=function(a){return Math.abs(this._getX(a[0])-this._getX(a[1]))};
cr.TouchUtils.prototype.ySpan=function(a){return Math.abs(this._getY(a[0])-this._getY(a[1]))};cr.TouchUtils.prototype.isXPinch=function(a){return 2==a.length&&this.xSpan(a)>this.ySpan(a)};cr.TouchUtils.prototype.isYPinch=function(a){return 2==a.length&&this.ySpan(a)>this.xSpan(a)};cr.TouchUtils.getElementPagePosition=function(a){var b={x:0,y:0};if(a){do b.x+=a.offsetLeft,b.y+=a.offsetTop,a=a.offsetParent;while(null!=a)}return b};
cr.TouchUtils.filterTouchesForElement=function(a,b){var c=[];if(a&&0<a.length)for(var d=0;d<a.length;d++){var e=a[d];e.target&&e.target.id==b&&c.push(e)}return c};"use strict";cr=cr||{};
cr.Plot=function(a,b,c,d){this.point=null;this.id="plot:"+b.getId()+":"+c.getId()+":"+cr.Uuid.getUuid();this.xAxis=b;this.yAxis=c;this.datasource=a;this.view={};this.bounds={xmin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymin:Number.MAX_VALUE,ymax:-Number.MAX_VALUE};this.view={xmin:this.xAxis._min,xmax:this.xAxis._max,ymin:this.yAxis._min,ymax:this.yAxis._max};this.tlayer=null;this.dataPointListeners=[];this._publishedPoint=null;this._resolutionScale=window.devicePixelRatio||1};
cr.Plot.prototype.limitView=function(){this.view.xmax-this.view.xmin>this.bounds.xmax-this.bounds.xmin?(this.view.xmax=this.bounds.xmax,this.view.xmin=this.bounds.xmin):this.view.xmin<this.bounds.xmin?(this.view.xmax+=this.bounds.xmin-this.view.xmin,this.view.xmin=this.bounds.xmin):this.view.xmax>this.bounds.xmax&&(this.view.xmin-=this.view.xmax-this.bounds.xmax,this.view.xmax=this.bounds.xmax)};cr.Plot.prototype.getId=function(){return this.id};
cr.Plot.prototype.getView=function(){return{xmin:this.xAxis._min,xmax:this.xAxis._max,ymin:this.yAxis._min,ymax:this.yAxis._max}};cr.Plot.prototype.update=function(){this.tlayer.draw(this.getView());this._needsUpdate=this.tlayer._needsUpdate};cr.Plot.prototype.addDataPointListener=function(a){this.dataPointListeners.push(a)};
cr.Plot.prototype.removeDataPointListener=function(a){for(var b=0;b<this.dataPointListeners.length&&this.dataPointListeners[b]!=a;b++);b<this.dataPointListeners.length&&this.dataPointListeners.splice(b,1)};
cr.Plot.prototype.getClosestDataPointToTimeWithinWindow=function(a,b,c){var d=null;(a=(a=this.tlayer.getPointsNearTimeWithinTimeRange(a,b,c))&&a.closestPoint?a.closestPoint:null)&&null!=a.y&&isFinite(a.y)&&!isNaN(a.y)&&(d={date:a.x,value:a.y,dateString:cr.DateTimeFormatter.format(1E3*a.x),valueString:cr.ValueFormatter.format(a.y),comment:null});return d};
cr.Plot.prototype.getMinMaxValuesWithinTimeRange=function(a,b){if(a<=b){var c=this.xAxis.getRange();a=Math.max(a,c.min);b=Math.min(b,c.max);return this.tlayer.getMinMaxValue({min:a,max:b})}return null};
cr.Plot.prototype.publishDataPoint=function(a){if(a){if(null==this._publishedPoint||a.x!=this._publishedPoint.x||a.y!=this._publishedPoint.y)for(this._publishedPoint={x:a.x,y:a.y,dateString:cr.DateTimeFormatter.format(1E3*a.x),valueString:cr.ValueFormatter.format(a.y),comment:null},a=0;a<this.dataPointListeners.length;a++)this.dataPointListeners[a](this._publishedPoint)}else if(null!=this._publishedPoint)for(this._publishedPoint=null,a=0;a<this.dataPointListeners.length;a++)this.dataPointListeners[a](this._publishedPoint)};
"use strict";cr=cr||{};
cr.SeriesPlotContainer=function(a,b,c){c=c||{};this.div=document.getElementById(a);this.div.style.border="1px solid black";this.highlightedPoints=[];this.cursorX=null;this._resolutionScale=window.devicePixelRatio||1;this._plots={};this._isAutoscaleEnabled=!!c.isAutoScaleEnabled;this._isAutoscalePaddingEnabled=!!c.isAutoscalePaddingEnabled;this._touchTargetPagePosition=null;this.midnightLine=new cr.MidnightLine;if(b)for(a=0;a<b.length;a++)this.addPlot(b[a]);this._initCanvases();try{console.log("Using webgl..."),
this.gl=this.canvas3d.getContext("experimental-webgl"),this.glb=new cr.Glb(this.gl),this.pointProgram=this.glb.programFromSources(cr.Shaders.PointVertexShader,cr.Shaders.PointFragmentShader),this.lineProgram=this.glb.programFromSources(cr.Shaders.TileVertexShader,cr.Shaders.TileFragmentShader),this.usewebgl=!0}catch(d){this.glb=this.gl=null,this.usewebgl=!1,console.log("experimental-webgl unsupported")}null==this.grapher&&(this.grapher=__grapher__);this.grapher.addPlotContainer(this);this._previousTouches=
null;this.touchUtils=new cr.TouchUtils;this._canvas=null;this._canvas=this.usewebgl?this.canvas2d:this.canvas3d;b=$("#"+this._canvas.id);b.bind("touchstart",this,this.touchstart);b.bind("touchmove",this,this.touchmove);b.bind("touchend",this,this.touchend);b.bind("touchcancel",this,this.touchend);this.resize()};cr.SeriesPlotContainer.prototype.getXAxis=function(){var a=Object.keys(this._plots);return 0==a.length?null:this._plots[a[0]].xAxis};cr.SeriesPlotContainer.prototype.getId=function(){return this.div.id};
cr.SeriesPlotContainer.prototype._initCanvases=function(){this.canvas3d=document.createElement("canvas");this.canvas3d.setAttribute("id",this.div.id+"-canvas3d");this.canvas3d.style.width=this.div.style.width;this.canvas3d.style.height=this.div.style.height;this.canvas3d.style.position="absolute";this.div.appendChild(this.canvas3d);this.canvas2d=document.createElement("canvas");this.canvas2d.setAttribute("id",this.div.id+"-canvas2d");this.canvas2d.style.width=this.div.style.width;this.canvas2d.style.height=
this.div.style.height;this.canvas2d.style.position="absolute";this.div.appendChild(this.canvas2d);this.ctx=this.canvas2d.getContext("2d");var a=$("#"+this.canvas2d.id);a.mousedown(this,this.mousedown);a.mousemove(this,this.mousemove);a.mouseup(this,this.mouseup);a.on("mousewheel",this,this.mousewheel);a=$("#"+this.canvas3d.id);a.mousedown(this,this.mousedown);a.mousemove(this,this.mousemove);a.mouseup(this,this.mouseup);a.on("mousewheel",this,this.mousewheel);this.lastMouse=null};
cr.SeriesPlotContainer.prototype.mousedown=function(a){var b=a.data;b.lastMouse=a;var c=a.offsetX-5,d=a.offsetX+5,e=a.offsetY+5,f=a.offsetY-5;Object.keys(b._plots).forEach(function(a){a=b._plots[a];var h={};h.xmin=a.xAxis.pixelToX(c);h.xmax=a.xAxis.pixelToX(d);h.ymin=a.yAxis.pixelToY(e);h.ymax=a.yAxis.pixelToY(f);if(h=a.tlayer.search(h))a.xAxis.setCursorPosition(h.x),b.grapher.scheduleUpdate()});return!1};
cr.SeriesPlotContainer.prototype.mousemove=function(a){var b=a.data;if(a.which){if(b.lastMouse){var c={},d={};Object.keys(b._plots).forEach(function(e){e=b._plots[e];e.xAxis.id in c||(e.xAxis.translatePixels(a.clientX-b.lastMouse.clientX),c[e.xAxis.id]=!0);e.yAxis.id in d||(e.yAxis.translatePixels(b.lastMouse.clientY-a.clientY),d[e.yAxis.id]=!0)});b.lastMouse=a}return!1}var e=a.offsetX-5,f=a.offsetX+5,g=a.offsetY+5,h=a.offsetY-5;Object.keys(b._plots).forEach(function(a){var c=b._plots[a],d={};d.xmin=
c.xAxis.pixelToX(e);d.xmax=c.xAxis.pixelToX(f);d.ymin=c.yAxis.pixelToY(g);d.ymax=c.yAxis.pixelToY(h);(d=c.tlayer.search(d))?(b.mouseoverHighlightPoint={point:d,plotKey:a},b.grapher.scheduleUpdate(),c.publishDataPoint(d)):(c.publishDataPoint(null),b.mouseoverHighlightPoint&&(b.mouseoverHighlightPoint=null,b.grapher.scheduleUpdate()))});b.mouseup(a)};cr.SeriesPlotContainer.prototype.mouseup=function(a){a.data.lastMouse=null};
cr.SeriesPlotContainer.prototype.mousewheel=function(a){var b=a.data;Object.keys(b._plots).forEach(function(c){c=b._plots[c];c.xAxis.zoomAboutX(a.offsetX,Math.pow(1.0005,-a.originalEvent.deltaY));c.yAxis.zoomAboutY(a.offsetY,Math.pow(1.0005,-a.originalEvent.deltaY))});return!1};
cr.SeriesPlotContainer.prototype.touchstart=function(a){var b=a.data;b._previousTouches=cr.TouchUtils.filterTouchesForElement(a.originalEvent.touches,b._canvas.id).slice(0,2);var c=cr.TouchUtils.getElementPagePosition(b.div);2<=b._previousTouches.length&&(b._touchTargetPagePosition=c);if(1==b._previousTouches.length){var d=b.touchUtils.centroid(b._previousTouches);a=d.x-c.x;var c=d.y-c.y,e=a-15,f=a+15,g=c+15,h=c-15;Object.keys(b._plots).forEach(function(a){a=b._plots[a];var c={};c.xmin=a.xAxis.pixelToX(e);
c.xmax=a.xAxis.pixelToX(f);c.ymin=a.yAxis.pixelToY(g);c.ymax=a.yAxis.pixelToY(h);if(c=a.tlayer.search(c))a.xAxis.setCursorPosition(c.x),b.grapher.scheduleUpdate()})}return!1};
cr.SeriesPlotContainer.prototype.touchmove=function(a){var b=a.data,c=cr.TouchUtils.filterTouchesForElement(a.originalEvent.touches,b._canvas.id).slice(0,2);if(b._previousTouches&&c.length==b._previousTouches.length){var d=b.touchUtils.centroid(c);a=b.touchUtils.centroid(b._previousTouches);var e=d.x-a.x,f=a.y-d.y;a=b.getXAxis();a.translatePixels(e);if(b.touchUtils.isXPinch(c)&&b.touchUtils.isXPinch(b._previousTouches)){var e=d.x-b._touchTargetPagePosition.x,g=b.touchUtils.xSpan(c)/b.touchUtils.xSpan(b._previousTouches);
a.zoomAboutX(e,g)}var h={};Object.keys(b._plots).forEach(function(a){a=b._plots[a];if(!(a.yAxis.id in h)){a.yAxis.translatePixels(f);if(b.touchUtils.isYPinch(c)&&b.touchUtils.isYPinch(b._previousTouches)){var e=d.y-b._touchTargetPagePosition.y,g=b.touchUtils.ySpan(c)/b.touchUtils.ySpan(b._previousTouches);a.yAxis.zoomAboutY(e,g)}h[a.yAxis.id]=!0}})}b._previousTouches=b.touchUtils.copyTouches(c);return!1};cr.SeriesPlotContainer.prototype.touchend=function(a){a.data._previousTouches=null;return!1};
cr.SeriesPlotContainer.prototype._padRange=function(a){a={min:a.min,max:a.max};var b=a.max-a.min;isFinite(b)&&(b=1E-10>b?.5:.05*b,a.min-=b,a.max+=b);return a};
cr.SeriesPlotContainer.prototype.update=function(){this.usewebgl||this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);this.drawHighlight();if(this._isAutoscaleEnabled){var a={},b=this.getXAxis().getRange(),c;for(c in this._plots){var d=this._plots[c],e=d.yAxis,f=a[e.id],d=d.tlayer.getMinMaxValue(b);null!=d&&("undefined"===typeof f?(f=d,a[e.id]=f):(f.min=Math.min(d.min,f.min),f.max=Math.max(d.max,f.max)));"undefined"!==typeof f&&null!=f&&(this._isAutoscalePaddingEnabled&&(f=this._padRange(f)),
e.setRange(f.min,f.max))}}this.glb&&this.glb.clear();a={};for(c in this._plots)d=this._plots[c],d.update(),a[d.yAxis.id]=d.yAxis;for(var g in a)a[g].update();this._needsUpdate=!1;for(c in this._plots)if(this._plots[c]._needsUpdate){this._needsUpdate=!0;break}this.drawHighlight();this.drawMidnightLines();this.drawHighlightPoints();this.drawMouseoverHighlightPoint()};
cr.SeriesPlotContainer.prototype.drawHighlightWebgl=function(){var a=this.getXAxis(),b=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),c=2/(a._max-a._min),d=-a._min*c-1,a=this.gl;a.lineWidth(2*this._resolutionScale);a.useProgram(this.lineProgram);var e=a.getUniformLocation(this.lineProgram,"u_pMatrix");a.uniformMatrix4fv(e,!1,b);b=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,b);a.bufferData(a.ARRAY_BUFFER,new Float32Array([this.cursorX*c+d,1,this.cursorX*c+d,-1]),a.STATIC_DRAW);c=a.getAttribLocation(this.lineProgram,
"a_position");a.enableVertexAttribArray(c);a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0);c=a.getUniformLocation(this.lineProgram,"u_color");a.uniform4f(c,1,0,0,1);a.drawArrays(a.LINES,0,2)};
cr.SeriesPlotContainer.prototype.drawHighlightCanvas=function(){var a=this.getXAxis();this.ctx.beginPath();this.ctx.lineWidth=2*this._resolutionScale;this.ctx.strokeStyle="rgb(255,0,0)";var b=this.ctx.canvas.width/(a._max-a._min),a=-a._min;this.ctx.moveTo(b*(this.cursorX+a),0);this.ctx.lineTo(b*(this.cursorX+a),this.ctx.canvas.height);this.ctx.stroke()};
cr.SeriesPlotContainer.prototype.drawHighlight=function(){var a=this.getXAxis();a.cursorX&&(this.cursorX!=a.cursorX&&(this.cursorX=a.cursorX,this.setHighlightPoints()),this.usewebgl?this.drawHighlightWebgl():this.drawHighlightCanvas())};cr.SeriesPlotContainer.prototype.drawMidnightLines=function(){var a=this.getXAxis();this.midnightLine.shouldDrawMidnightLines(a)&&(this.usewebgl?this.drawMidnightLinesWebgl():this.drawMidnightLinesCanvas())};
cr.SeriesPlotContainer.prototype.drawMidnightLinesWebgl=function(){var a=this.getXAxis(),a=this.midnightLine.getLines(a),b=this.gl,c=new Float32Array([2*this._resolutionScale/b.canvas.width,0,0,0,0,1,0,0,0,0,1,0,-1,0,0,1]);b.lineWidth(1*this._resolutionScale);b.useProgram(this.lineProgram);var d=b.getUniformLocation(this.lineProgram,"u_pMatrix");b.uniformMatrix4fv(d,!1,c);c=b.createBuffer();b.bindBuffer(b.ARRAY_BUFFER,c);b.bufferData(b.ARRAY_BUFFER,new Float32Array(a),b.STATIC_DRAW);c=b.getAttribLocation(this.lineProgram,
"a_position");b.enableVertexAttribArray(c);b.vertexAttribPointer(c,2,b.FLOAT,!1,0,0);c=b.getUniformLocation(this.lineProgram,"u_color");b.uniform4f(c,.5,.5,.5,.7);b.drawArrays(b.LINES,0,a.length/2)};cr.SeriesPlotContainer.prototype.drawMidnightLinesCanvas=function(){};
cr.SeriesPlotContainer.prototype.setHighlightPoints=function(){this.highlightedPoints=[];var a=this.getXAxis(),a=a.pixelToX(2)-a.pixelToX(0),b;for(b in this._plots){var c=this._plots[b].tlayer.getPointsNearTimeWithinTimeRange(this.cursorX,a,a);(c=c&&c.closestPoint?c.closestPoint:null)&&this.highlightedPoints.push({point:c,plotKey:b})}};
cr.SeriesPlotContainer.prototype.drawHighlightPointsWebgl=function(){for(var a=this.getXAxis(),b=[],c=2/(a._max-a._min),a=-a._min*c-1,d=0;d<this.highlightedPoints.length;d++){var e=this.highlightedPoints[d],f=this._plots[e.plotKey].getView(),g=2/(f.ymax-f.ymin),f=-f.ymin*g-1;b.push(e.point.x*c+a);b.push(e.point.y*g+f)}c=this.gl;c.useProgram(this.pointProgram);a=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);d=c.getUniformLocation(this.pointProgram,"u_pMatrix");c.uniformMatrix4fv(d,!1,a);a=c.createBuffer();
c.bindBuffer(c.ARRAY_BUFFER,a);c.bufferData(c.ARRAY_BUFFER,new Float32Array(b),c.STATIC_DRAW);a=c.getAttribLocation(this.pointProgram,"a_position");c.enableVertexAttribArray(a);c.vertexAttribPointer(a,2,c.FLOAT,!1,0,0);a=c.getUniformLocation(this.pointProgram,"u_color");c.uniform4f(a,1,0,0,1);c.drawArrays(c.POINTS,0,b.length/2)};
cr.SeriesPlotContainer.prototype.drawHighlightPointsCanvas=function(){for(var a=this.getXAxis(),b=[],c=-a._min,a=this.ctx.canvas.width/(a._max-a._min),d=0;d<this.highlightedPoints.length;d++){var e=this.highlightedPoints[d],f=this._plots[e.plotKey].getView();b.push({x:a*(e.point.x+c),y:this.ctx.canvas.height/(f.ymin-f.ymax)*(e.point.y+-f.ymax)})}for(d=0;d<b.length;d++)this.ctx.beginPath(),this.ctx.fillStyle="red",this.ctx.arc(b[d].x,b[d].y,2*this._resolutionScale,0,2*Math.PI,!0),this.ctx.fill()};
cr.SeriesPlotContainer.prototype.drawHighlightPoints=function(){this.getXAxis().cursorX&&(this.usewebgl?this.drawHighlightPointsWebgl():this.drawHighlightPointsCanvas())};
cr.SeriesPlotContainer.prototype.drawMouseoverHighlightPointWebgl=function(){var a=this.getXAxis();if(this.mouseoverHighlightPoint){var b=[],c=this.mouseoverHighlightPoint,d=this._plots[c.plotKey].getView(),e=2/(a._max-a._min),f=2/(d.ymax-d.ymin),d=-d.ymin*f-1;b.push(c.point.x*e+(-a._min*e-1));b.push(c.point.y*f+d);a=this.gl;a.useProgram(this.pointProgram);c=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);e=a.getUniformLocation(this.pointProgram,"u_pMatrix");a.uniformMatrix4fv(e,!1,c);c=a.createBuffer();
a.bindBuffer(a.ARRAY_BUFFER,c);a.bufferData(a.ARRAY_BUFFER,new Float32Array(b),a.STATIC_DRAW);c=a.getAttribLocation(this.pointProgram,"a_position");a.enableVertexAttribArray(c);a.vertexAttribPointer(c,2,a.FLOAT,!1,0,0);c=a.getUniformLocation(this.pointProgram,"u_color");a.uniform4f(c,1,0,0,1);a.drawArrays(a.POINTS,0,b.length/2)}};cr.SeriesPlotContainer.prototype.drawMouseoverHighlightPointCanvas=function(){};
cr.SeriesPlotContainer.prototype.drawMouseoverHighlightPoint=function(){this.usewebgl?this.drawMouseoverHighlightPointWebgl():this.drawMouseoverHighlightPointCanvas()};
cr.SeriesPlotContainer.prototype.resize=function(){var a=parseInt(this.div.style.width)*this._resolutionScale,b=parseInt(this.div.style.height)*this._resolutionScale;if(this.canvas2d.width!=a||this.canvas2d.height!=b)this.canvas2d.width=this.canvas3d.width=a,this.canvas2d.height=this.canvas3d.height=b,this.canvas3d.style.width=this.div.style.width,this.canvas3d.style.height=this.div.style.height,this.canvas2d.style.width=this.div.style.width,this.canvas2d.style.height=this.div.style.height;this.usewebgl&&
this.gl.viewport(0,0,this.canvas3d.width,this.canvas3d.height)};cr.SeriesPlotContainer.prototype.addPlot=function(a){var b=a.getId();this._plots[b]=a;this._plots[b].tlayer=new cr.DataStoreTileLayer(a.datasource,this.glb,this.ctx);this._plots[b].tlayer.usewebgl=this.usewebgl};
cr.SeriesPlotContainer.prototype.removePlot=function(a){var b=a.getId();this.highlightedPoints=this.highlightedPoints.filter(function(a){return a&&a.plotKey!=b});this.mouseoverHighlightPoint&&this.mouseoverHighlightPoint.plotKey==b&&(this.mouseoverHighlightPoint=null);delete this._plots[b]};cr.SeriesPlotContainer.prototype.setSize=function(a,b){this.div.style.width=a+"px";this.div.style.height=b+"px";this.resize()};
cr.SeriesPlotContainer.prototype.setAutoScaleEnabled=function(a,b){this._isAutoscaleEnabled=a;this._isAutoscalePaddingEnabled=!!b;a&&this.grapher.scheduleUpdate()};"use strict";cr=cr||{};
cr.Grapher=function(){this._isAdded=!0;this._isAnimated=!1;this.plotContainer=this.timeGraphAxis=this._requestAnimationFrameId=this._updateHandler=null;this.plotContainers={};this._requestUpdateFunction=function(a,b){return function(){b.apply(a)}}(this,this._update);this.bounds={xmin:Number.MAX_VALUE,xmax:-Number.MAX_VALUE,ymin:Number.MAX_VALUE,ymax:-Number.MAX_VALUE};this.view={xmin:this.bounds.xmin,xmax:this.bounds.xmax,ymin:this.bounds.ymin,ymax:this.bounds.ymax}};
cr.Grapher.prototype.addPlotContainer=function(a){this.plotContainer=a;this.plotContainers[a.div.id]=a};cr.Grapher.prototype._requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/60)};
cr.Grapher.prototype._cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(a){};cr.Grapher.prototype.setAnimate=function(a){if(this._isAnimated=!!a)console.log("scheduling update"),this.scheduleUpdate()};cr.Grapher.prototype.isAnimated=function(){return this._isAnimated};
cr.Grapher.prototype._update=function(){this._requestAnimationFrameId=null;if(this._isAdded){this._isAnimated&&this.scheduleUpdate();this._needsResize&&this._resizeHandler&&(this._needsResize=!1,this._resizeHandler());this.timeGraphAxis&&this.timeGraphAxis.update();if(this.plotContainers)for(var a=Object.keys(this.plotContainers),b=0;b<a.length;b++)this.plotContainers[a[b]].update(),this.plotContainer._needsUpdate&&this.scheduleUpdate();this._updateHandler&&this._updateHandler()}};
cr.Grapher.prototype.scheduleUpdate=function(){this._isAdded&&!this._requestAnimationFrameId&&(this._requestAnimationFrameId=this._requestAnimFrame.call(window,this._requestUpdateFunction))};cr.Grapher.prototype.resize=function(){this.timeGraphAxis&&this.timeGraphAxis.resize();this.plotContainer&&this.plotContainer.resize();if(this.plotContainers)for(var a=Object.keys(this.plotContainers),b=0;b<a.length;b++)this.plotContainers[a[b]].resize();this.scheduleUpdate()};cr.Grapher.prototype.update=function(){this._update()};
var __grapher__=new cr.Grapher,DateAxis=function(a,b){return new cr.TimeGraphAxis(document.getElementById(a),null,null,cr.Basis.XAxisBasis,!0)},NumberAxis=function(a,b,c){var d;c=c||{min:-1*Number.MAX_VALUE,max:Number.MAX_VALUE};"vertical"==b?(b=cr.Basis.YAxisBasis,d=!1):(b=cr.Basis.XAxisBasis,d=!0);return new cr.GraphAxis(document.getElementById(a),c.min,c.max,b,d)},DataSeriesPlot=function(a,b,c,d){return new cr.Plot(a,b,c,d)},PlotContainer=function(a,b,c,d){return new cr.SeriesPlotContainer(a,c,
d)},SequenceNumber=function(){};SequenceNumber._hasWarningBeenLogged=!1;SequenceNumber.getNext=function(){SequenceNumber._hasWarningBeenLogged||(console.log("SequenceNumber is deprecated and unnecessary for the CREATE Lab Grapher"),SequenceNumber._hasWarningBeenLogged=!0);return 1};document.addEventListener("DOMContentLoaded",function(){var a=a||window.parent;a.grapherLoad&&a.grapherLoad()},!1);"use strict";cr=cr||{};cr.TileConstants=function(){};cr.TileConstants.TILE_BOUNDARY_SENTINAL_VALUE=-1E308;
Object.freeze(cr.TileConstants);"use strict";cr=cr||{};cr.TimeConstants=function(){};cr.TimeConstants.SECONDS_IN_HOUR=3600;cr.TimeConstants.SECONDS_IN_DAY=24*cr.TimeConstants.SECONDS_IN_HOUR;cr.TimeConstants.SECONDS_IN_WEEK=7*cr.TimeConstants.SECONDS_IN_DAY;cr.TimeConstants.SECONDS_IN_YEAR=31556926;cr.TimeConstants.SECONDS_IN_DECADE=10*cr.TimeConstants.SECONDS_IN_YEAR;cr.TimeConstants.SECONDS_IN_CENTURY=10*cr.TimeConstants.SECONDS_IN_DECADE;
cr.TimeConstants.SECONDS_IN_MONTH=Math.round(cr.TimeConstants.SECONDS_IN_YEAR/12);Object.freeze(cr.TimeConstants);"use strict";cr=cr||{};cr.Uuid=function(){};cr.Uuid.getUuid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};"use strict";cr=cr||{};
cr.MidnightLine=function(){this.SECONDS_PER_DAY=86400;this.MILLISECONDS_PER_DAY=1E3*this.SECONDS_PER_DAY;this.STROKE_WIDTH=.5;this.STROKE_COLOR="silver";this.MIN_SPACING=20};cr.MidnightLine.prototype.getLines=function(a){var b=[];if(this.shouldDrawMidnightLines(a))for(var c=a.getMin(),d=a.getMax(),c=this.getNextDay(c);c<=d;)b.push(a.project1D(c)),b.push(1),b.push(a.project1D(c)),b.push(-1),c+=this.SECONDS_PER_DAY;return b};
cr.MidnightLine.prototype.shouldDrawMidnightLines=function(a){var b=a.getMin();return a.project2D(b+this.SECONDS_PER_DAY).getX()-a.project2D(b).getX()>=this.MIN_SPACING};cr.MidnightLine.prototype.getNextDay=function(a){a=new Date(1E3*a);a.setTime(a.getTime()+this.MILLISECONDS_PER_DAY-1);a.setHours(0);a.setMinutes(0);a.setSeconds(0);return a.getTime()/1E3};
